<div class="section" id="introduction">
<h1>Introduction</h1>
<p>静态网站生成工具(static site generator)非常多,
在<a class="reference external" href="https://www.staticgen.com/">这里</a>
就可以看到开源的众多静态网站生成工具. 不少工具都有它们各自的特点,
比如Hugo用golang编写, 在编译网页时速度比其它框架更快, 但缺点也比较明显,
做个性化扩展比较麻烦. 这里选择Nikola是考虑到它是由Python编写,
编译速度也比常见的Jekyll等要快不少, 且开发活跃,
被很多科研人员选作博客工具. 我比较看重的Nikola特性有:</p>
<!-- TEASER_END -->
<ul class="simple">
<li>支持LaTeX数学公式(via MathJax)</li>
<li>原生支持多种文档类型, 包括:<ul>
<li>reStructuredText (<tt class="docutils literal">.rst</tt>, <tt class="docutils literal">.txt</tt>, 此为默认格式, 故 <tt class="docutils literal">.txt</tt>
文件也是以reStructuredText格式来读取的)</li>
<li>markdown (<tt class="docutils literal">.md</tt>)</li>
<li>Jupyter/IPython Notebook (<tt class="docutils literal">.ipynb</tt>)</li>
<li>HTML (<tt class="docutils literal">.html</tt>)</li>
<li>PHP (<tt class="docutils literal">.php</tt>)</li>
<li>Pandoc支持的格式, 如Textile, LaTeX, Emacs Org-Mode, MS Word等
(Pandoc需要手动开启支持, 默认关闭因可能会与已有格式冲突)</li>
</ul>
</li>
<li>能过插件支持更多类型文档, 例如 Emacs Org-Mode, reST with HTML 5
output 等</li>
</ul>
<p>除此之外, 它还有很多其它特点, 比如提供image gallery, image slideshow
模板, 以及个性化的输出路径定制等.</p>
<p>配置参考<a class="reference external" href="https://getnikola.com/getting-started.html">官方指导</a>和<a class="reference external" href="https://getnikola.com/handbook.html">手册</a>,
本文针对Windows和Anaconda作更详细的说明.</p>
</div>
<div class="section" id="nikola">
<h1>安装Nikola</h1>
<ul>
<li><p class="first">选择一: 直接安装Python</p>
<ul>
<li><p class="first">安装Python3: 打开Python官网安装32位python3.
(即使是64位系统也推荐使用兼容性较好的32位python). 安装完后
<tt class="docutils literal">python <span class="pre">--version</span></tt> 查看版本信息.</p>
</li>
<li><p class="first">安装 <tt class="docutils literal">virtualenv</tt>: 进入到python安装目录
<tt class="docutils literal"><span class="pre">AppData\Local\Programs\Python\Python35-32</span></tt>,
<tt class="docutils literal">python <span class="pre">-m</span> pip install virtualenv</tt></p>
</li>
<li><p class="first">新建一个虚拟环境用于安装nikola(当然也可以省掉这步,
直接把nikola安装在global环境下)</p>
<pre class="code shell"><a name="rest_code_fc2b7226820f407f9c2c232c82cfc650-1"></a>virtualenv nikola
<a name="rest_code_fc2b7226820f407f9c2c232c82cfc650-2"></a><span class="nb">cd</span> nikola/Scripts
<a name="rest_code_fc2b7226820f407f9c2c232c82cfc650-3"></a>activate.bat
</pre><p>说明: 创建一个叫做nikola的虚拟环境. 这里视情况不同,
如果提示命令失败可以尝试使用 <tt class="docutils literal">virtualenv3</tt>, <tt class="docutils literal"><span class="pre">virtualenv-3.x</span></tt>
(其中x为python版本), 或者 <tt class="docutils literal">virtualenv <span class="pre">-p</span> /usr/bin/python3</tt>.
因win下没有source命令, 故使用.bat文件进行激活这个虚似环境.
Linux下使用 <tt class="docutils literal">source bin/activate</tt> 命令. 执行完上面命令,
此时命令行左侧会出现 <tt class="docutils literal">(nikola)</tt>,
表明当前的命令将会在这个虚拟环境下执行.</p>
</li>
<li><p class="first">在 <tt class="docutils literal">(nikola)</tt> 环境下安装 <tt class="docutils literal">lxml</tt> 与 <tt class="docutils literal">Pillow</tt>:
下载好这两个whl文件后, 把它们复制到python安装目录
<tt class="docutils literal"><span class="pre">AppData\Local\Programs\Python\Python35-32</span></tt> 下方便操作,
并在该目录下执行(如果出错提示, 则需要先安装wheel,
再通过wheel安装它们):</p>
<pre class="code shell"><a name="rest_code_b2758291f18e4151a49941ffa7da1ce3-1"></a>python -m pip install Pillow-3.2.0-cp35-cp35m-win32.whl
<a name="rest_code_b2758291f18e4151a49941ffa7da1ce3-2"></a>python -m pip install lxml-3.6.0-cp35-cp35m-win32.whl
<a name="rest_code_b2758291f18e4151a49941ffa7da1ce3-3"></a><span class="nb">cd</span> .. <span class="c1"># back to nikola directory</span>
<a name="rest_code_b2758291f18e4151a49941ffa7da1ce3-4"></a>pip install --upgrade <span class="s2">&quot;Nikola[extras]&quot;</span>
</pre></li>
</ul>
</li>
<li><p class="first">选择二: 通过Anaconda安装 (本文选择此方法)</p>
<ul>
<li><p class="first">安装Anaconda, 如果系统已有, 先升级Anaconda (在Anaconda prompt中使用 <tt class="docutils literal">conda update <span class="pre">--all</span></tt> 命令升级所有package.)</p>
</li>
<li><p class="first">查看python版本, 使用anaconda prompt命令行工具:</p>
<pre class="code shell"><a name="rest_code_8c8322704d7e4ce39710c42700f785dc-1"></a><span class="o">[</span>Anaconda3<span class="o">]</span> C:<span class="se">\h</span>ome&gt;python --version
<a name="rest_code_8c8322704d7e4ce39710c42700f785dc-2"></a>Python 3.5.1 :: Anaconda 4.0.0 <span class="o">(</span>64-bit<span class="o">)</span>
</pre><p>创建一个叫myblog虚拟环境:</p>
<pre class="code shell"><a name="rest_code_7d9ab10426854d108422f2de6544858a-1"></a><span class="o">[</span>Anaconda3<span class="o">]</span> C:<span class="se">\h</span>ome&gt;conda create -n myblog <span class="nv">python</span><span class="o">=</span>3.5 anaconda
<a name="rest_code_7d9ab10426854d108422f2de6544858a-2"></a><span class="o">[</span>Anaconda3<span class="o">]</span> C:<span class="se">\h</span>ome&gt;activate myblog <span class="c1"># use &quot;source activate myblog&quot; on linux</span>
<a name="rest_code_7d9ab10426854d108422f2de6544858a-3"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome&gt;pip install <span class="s2">&quot;Nikola[extras]&quot;</span>
</pre><p>升级nikola时, 先升级Anaconda, 再按照上面步骤, 最后一步使用 <tt class="docutils literal">pip install <span class="pre">--upgrade</span> &quot;Nikola[extras]</tt>. 我在升级7.7.9时报错, 于是直接先删除了Nikola再重新安装新版. 即 <tt class="docutils literal">pip uninstall &quot;Nikola[extras]&quot;</tt>, 之后再使用 <tt class="docutils literal">pip install &quot;Nikola[extras]&quot;</tt> 安装.</p>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id1">
<h1>创建项目</h1>
<ul>
<li><p class="first">新建项目 新建一个目录 <tt class="docutils literal"><span class="pre">C:/home/mynikolasite</span></tt> 用于存放新建的项目:</p>
<pre class="code shell"><a name="rest_code_1467a836019c47728bad5e31f78388cb-1"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome&gt;nikola init --demo mynikolasite <span class="c1"># create an empty project without &quot;--demo&quot; option</span>
</pre><p>这里nikola会问几个问题, 其中一个问到语言, 我们选择英文, 即输入
<tt class="docutils literal">en</tt>, 其余的可视情况填写, 这些设置以后还可以在配置文件 <tt class="docutils literal">conf.py</tt>
中更改.</p>
</li>
<li><p class="first">主题 在 <a class="reference external" href="https://themes.getnikola.com/">https://themes.getnikola.com/</a> 可以找到nikola的各种主题,
安装主题 <tt class="docutils literal">bootstrap3</tt>, 为使主题生效, 需要另外在 <tt class="docutils literal">conf.py</tt> 中设置
<tt class="docutils literal">THEME</tt> 变量:</p>
<pre class="code shell"><a name="rest_code_d25db58879724cd98575be125bb8e4b8-1"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome&gt;cd mynikolasite
<a name="rest_code_d25db58879724cd98575be125bb8e4b8-2"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome<span class="se">\m</span>ynikolasite&gt;nikola install_theme bootstrap3
</pre></li>
<li><p class="first">配置 <tt class="docutils literal">conf.py</tt> 文件</p>
<ul class="simple">
<li>这里我们可以编辑刚才创建时选项, 如 <tt class="docutils literal">SITE_URL</tt> 设置为
“<a class="reference external" href="https://defnil.github.io/">https://defnil.github.io/</a>” (为方便发布到Github, 注意要以 <tt class="docutils literal">/</tt>
结尾).</li>
<li>排名第一位的格式是默认格式。如下面的 <tt class="docutils literal">.rst</tt> 格式，用户也可以将自己</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">&lt;string&gt;</tt>, line 124)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</div>
<p>偏好的格式移到第一位。
-  如果页面要使用markdown和ipython notebook, 需要设置 <tt class="docutils literal">POSTS</tt> 与</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">&lt;string&gt;</tt>, line 126)</p>
<p>Unexpected indentation.</p>
</div>
<blockquote>
<p><tt class="docutils literal">PAGES</tt> 项(下面各增加了后几项,
顺便吐槽以前在nikola中page居然被叫做story!!!):</p>
<pre class="code python"><a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-1"></a><span class="n">POSTS</span> <span class="o">=</span> <span class="p">(</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-2"></a>    <span class="p">(</span><span class="s2">&quot;posts/*.rst&quot;</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;post.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-3"></a>    <span class="p">(</span><span class="s2">&quot;posts/*.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;post.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-4"></a>    <span class="p">(</span><span class="s2">&quot;posts/*.html&quot;</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;post.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-5"></a>    <span class="p">(</span><span class="s2">&quot;posts/*.md&quot;</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;post.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-6"></a>    <span class="p">(</span><span class="s2">&quot;posts/*.ipynb&quot;</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;post.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-7"></a>    <span class="p">(</span><span class="s2">&quot;posts/*.org&quot;</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;post.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-8"></a><span class="p">)</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-9"></a><span class="n">PAGES</span> <span class="o">=</span> <span class="p">(</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-10"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.rst&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-11"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-12"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.html&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-13"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.md&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-14"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.ipynb&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-15"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.org&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_6a785f0dfce4492c89b525d4c5f1f30e-16"></a><span class="p">)</span>
</pre></blockquote>
<ul>
<li><p class="first"><tt class="docutils literal">INDEX_TEASERS</tt> 设为 <tt class="docutils literal">True</tt> 可以启用teaser.
这时只需在每个post中加入 <tt class="docutils literal">.. TEASER_END</tt> (reST文件)或
<tt class="docutils literal"><span class="pre">&lt;!--TEASER_END--&gt;</span></tt> (markdown), 就可以使index
page只显示post的第一部分, 而对于org-mode, 需要
<tt class="docutils literal">#+HTML: <span class="pre">&lt;!--TEASER_END--&gt;</span></tt> 或者</p>
<pre class="code python"><a name="rest_code_219ad7dc39444897a950e1f3e1b5b6f3-1"></a><span class="c1">#+BEGIN_HTML</span>
<a name="rest_code_219ad7dc39444897a950e1f3e1b5b6f3-2"></a><span class="o">&lt;</span><span class="err">!</span><span class="o">--</span><span class="n">TEASER_END</span><span class="o">--&gt;</span>
<a name="rest_code_219ad7dc39444897a950e1f3e1b5b6f3-3"></a><span class="c1">#+END_HTML</span>
</pre><p>另外,</p>
<pre class="code python"><a name="rest_code_47f674e6f386468390646ed6d2f02003-1"></a><span class="n">INDEX_READ_MORE_LINK</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a name="rest_code_47f674e6f386468390646ed6d2f02003-2"></a><span class="n">FEED_READ_MORE_LINK</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</pre><p>可以禁止掉 “Reader more…”. 个人感觉没有必要,
因为禁掉后读者不能分清楚是否文章在这里真的已经完结还是只是摘要部分.</p>
</li>
<li><p class="first"><tt class="docutils literal">USE_BUNDLES</tt> 设为 <tt class="docutils literal">True</tt> 可以启用webassets
(前提是你已经安装了它), 这样可以获得速度上的提升.</p>
</li>
<li><p class="first">禁止评论功能:</p>
<pre class="code python"><a name="rest_code_84a40680e695494990128c906c8ecb07-1"></a><span class="n">COMMENT_SYSTEM</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</pre><p>也可以选择启用其它的评论支持, 如disqus, facebook等.</p>
</li>
<li><p class="first"><tt class="docutils literal">GENERATE_RSS</tt> 设为 <tt class="docutils literal">True</tt> 默认支持RSS, 如果设为 <tt class="docutils literal">False</tt>,
则会关闭任何与RSS相关的功能. 同时还需要在 <tt class="docutils literal">NAVIGATION_LINKS</tt>
把和RSS相关的页面去掉</p>
</li>
<li><p class="first">去掉Source links, 页面上将不会显示页面源代码的链接</p>
<pre class="code python"><a name="rest_code_62c95d7d40cb4340afc2e854eaef391c-1"></a><span class="n">SHOW_SOURCELINK</span> <span class="o">=</span> <span class="bp">False</span>
<a name="rest_code_62c95d7d40cb4340afc2e854eaef391c-2"></a><span class="n">COPY_SOURCES</span> <span class="o">=</span> <span class="bp">False</span>
</pre></li>
</ul>
</li>
<li><p class="first">编译</p>
<pre class="code shell"><a name="rest_code_8ba4e86bb00f421b9009158f39f10aab-1"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome<span class="se">\m</span>ynikolasite&gt;nikola build
</pre><p>因为之前我们使用了 <tt class="docutils literal"><span class="pre">--demo</span></tt>,
所以现在生成的网页已经包含了一些page在里面了. 我们可以看一看效果:</p>
<pre class="code shell"><a name="rest_code_da007968a89d45bfa93b4d0eb1856b6a-1"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome<span class="se">\m</span>ynikolasite&gt;nikola serve
</pre><p>这时使用流览器访问 <a class="reference external" href="http://localhost:8000/">http://localhost:8000/</a>
可以看到本地效果(Windows下使用命令 <tt class="docutils literal">nikola serve <span class="pre">-b</span></tt> 或者
<tt class="docutils literal">nikola serve <span class="pre">--browser</span></tt> 流览器会打开http://0.0.0.0:8000/,
则出现无法访问. 正确地址是 <a class="reference external" href="http://localhost:8000/">http://localhost:8000/</a>). 使用 <tt class="docutils literal">Ctrl+c</tt>
停止服务.</p>
</li>
</ul>
</div>
<div class="section" id="github">
<h1>发布到Github</h1>
<div class="section" id="id2">
<h2>方式一</h2>
<p>使用git发布网站有两种方式, 一种是创建两个branch, 一个存生成的网页,
另一个branch是整个build后的项目, 在两个branch之间切换,
这也是官方指导中的方法.</p>
<ul>
<li><p class="first">在Github上创建一个空的repo, 名字为 <tt class="docutils literal">defnil.github.io</tt>. 我们这里推荐使用项目主页，项目名字可以随便起，如 <tt class="docutils literal">sitename</tt></p>
</li>
<li><p class="first">在mynikolasite目录下创建.gitignore文件,(可直接下载使用<a class="reference external" href="https://github.com/getnikola/nikola/blob/master/.gitignore">文件</a>).</p>
</li>
<li><p class="first"><tt class="docutils literal">conf.py</tt> 相关设置如下:</p>
<pre class="code python"><a name="rest_code_e168043af85847498e04addf947feb33-1"></a><span class="n">GITHUB_SOURCE_BRANCH</span> <span class="o">=</span> <span class="s1">&#39;source&#39;</span> <span class="c1"># where your Nikola site source will be deployed. We default to master, but user pages should use src or something else.</span>
<a name="rest_code_e168043af85847498e04addf947feb33-2"></a><span class="n">GITHUB_DEPLOY_BRANCH</span> <span class="o">=</span> <span class="s1">&#39;gh-pages&#39;</span> <span class="c1"># where Nikola-generated HTML files will be deployed. It should be gh-pages for project pages and master for user pages (user.github.io).</span>
<a name="rest_code_e168043af85847498e04addf947feb33-3"></a><span class="n">GITHUB_REMOTE_NAME</span> <span class="o">=</span> <span class="s1">&#39;origin&#39;</span>
<a name="rest_code_e168043af85847498e04addf947feb33-4"></a><span class="n">GITHUB_COMMIT_SOURCE</span> <span class="o">=</span> <span class="bp">True</span>
</pre></li>
<li><p class="first">打开git bash,</p>
<pre class="code shell"><a name="rest_code_269e162d5f5849eabf703961458d7ebe-1"></a><span class="nb">cd</span> C:/home/mynikolasite
<a name="rest_code_269e162d5f5849eabf703961458d7ebe-2"></a>git init
<a name="rest_code_269e162d5f5849eabf703961458d7ebe-3"></a>git remote add origin git@github.com:defnil/sitename.git
</pre></li>
<li><p class="first">当你build满意后, 就可以执行 <tt class="docutils literal">nikola github_deploy</tt>,
不用亲自去commit, 也不用手动建立名为source的branch,
这一切都自动由nikola做好了. 以后每次要更新网站时只用build后使用
<tt class="docutils literal">nikola github_deploy</tt> 就可以完成github page的更新,
这一切都不需要切换到git命令行.</p>
</li>
</ul>
</div>
<div class="section" id="id3">
<h2>方式二</h2>
<p>另一种方案是直接用两个repo来存放:</p>
<ul>
<li><p class="first">在Github上创建两个空的repo, 名字分别叫 <tt class="docutils literal"><span class="pre">nikola-blog</span></tt> 和
<tt class="docutils literal">defnil.github.io</tt>, 其中 <tt class="docutils literal">defnil</tt> 是我Github的用户ID,
使用时需要换成你自己的ID. 注意不要包含readme或gitignore等文件.</p>
</li>
<li><p class="first">在mynikolasite目录下创建一个.gitignore文件, (可直接下载使用
<a class="reference external" href="https://github.com/getnikola/nikola/blob/master/.gitignore">https://github.com/getnikola/nikola/blob/master/.gitignore</a>
它已将output目录列进了忽略表中)</p>
</li>
<li><p class="first">打开一个git bash, 将所有mynikolasite内容push到 <tt class="docutils literal"><span class="pre">nikola-blog</span></tt>
这个repo里:</p>
<pre class="code shell"><a name="rest_code_491aa8a51dfb496482a3a6ca5e3b66b0-1"></a><span class="nb">cd</span> C:/home/mynikolasite
<a name="rest_code_491aa8a51dfb496482a3a6ca5e3b66b0-2"></a>git init
<a name="rest_code_491aa8a51dfb496482a3a6ca5e3b66b0-3"></a>git add .
<a name="rest_code_491aa8a51dfb496482a3a6ca5e3b66b0-4"></a>git commit -m <span class="s2">&quot;first commit&quot;</span>
<a name="rest_code_491aa8a51dfb496482a3a6ca5e3b66b0-5"></a>git remote add origin git@github.com:defnil/nikola-blog.git
<a name="rest_code_491aa8a51dfb496482a3a6ca5e3b66b0-6"></a>git push -u origin master
</pre></li>
<li><p class="first">再运行下面命令将output目录下的博客内容push到我们的blog site里, 即
<tt class="docutils literal">defnil.github.io</tt> 这个repo.</p>
<pre class="code shell"><a name="rest_code_335e6644d20346c2b57d1df030074d65-1"></a><span class="nb">cd</span> output
<a name="rest_code_335e6644d20346c2b57d1df030074d65-2"></a>git init
<a name="rest_code_335e6644d20346c2b57d1df030074d65-3"></a>git add .
<a name="rest_code_335e6644d20346c2b57d1df030074d65-4"></a>git commit -m <span class="s2">&quot;first blog commit&quot;</span>
<a name="rest_code_335e6644d20346c2b57d1df030074d65-5"></a>git remote add origin git@github.com:defnil/defnil.github.io.git
<a name="rest_code_335e6644d20346c2b57d1df030074d65-6"></a>git push -u origin master
</pre></li>
</ul>
</div>
<div class="section" id="use-custom-domain">
<h2>Use Custom Domain</h2>
<p>比如, 我们现在已经购买了域名 <tt class="docutils literal">abc.me</tt>,
希望能与刚才创建的Github页面关联.
假设我们用的是上述方法一来管理和发布页面的. 则先在本地的 <tt class="docutils literal">files/</tt>
目录下添加 <tt class="docutils literal">CNAME</tt> 文件, 其内容很简单, 只有 <tt class="docutils literal">abc.me</tt>.
可以用下面的命令实现:</p>
<pre class="code shell"><a name="rest_code_1920cce622e34091bd03b32f4df685dd-1"></a><span class="nb">cd</span> C:/home/mynikolasite
<a name="rest_code_1920cce622e34091bd03b32f4df685dd-2"></a><span class="nb">echo</span> <span class="s2">&quot;abc.me&quot;</span> &gt; files/CNAME
</pre><p>之后我们在完成编译后使用 <tt class="docutils literal">github_deploy</tt> 命令, <tt class="docutils literal">CNAME</tt> 会被拷贝到
<tt class="docutils literal">output/</tt> 目录下, 并会自动上传至 <tt class="docutils literal">defnil.github.io</tt> 的 <tt class="docutils literal">source</tt>
branch下.</p>
<pre class="code shell"><a name="rest_code_d47214ac2de344e68f7e475e47fd06cc-1"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome<span class="se">\m</span>ynikolasite&gt;nikola build
<a name="rest_code_d47214ac2de344e68f7e475e47fd06cc-2"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome<span class="se">\m</span>ynikolasite&gt;nikola github_deploy
</pre><p>接下来需要去域名服务商那里绑定, 以namecheap为例, 参考
<a class="reference external" href="https://www.namecheap.com/support/knowledgebase/article.aspx/9645/2208/how-do-i-link-my-domain-to-github-pages">这里</a>.
其中第1步我们已做过了相关设置, 略过直接从第2步开始. 完成这些步骤后,
就可以直接使用 <tt class="docutils literal">abc.me</tt> 访问刚才的 <tt class="docutils literal">defnil.github.io</tt> 了. 当然,
这时不要忘记将 <tt class="docutils literal">conf.py</tt> 中的 <tt class="docutils literal">SITE_URL</tt> 设为 “<a class="reference external" href="http://abc.me/">http://abc.me/</a>”.</p>
</div>
</div>
<div class="section" id="id4">
<h1>文档编辑</h1>
<div class="section" id="metadata">
<h2>metadata</h2>
<p>进入anaconda prompt,</p>
<pre class="code shell"><a name="rest_code_e8429324dbdf466eb0df0e217729b1c7-1"></a><span class="o">[</span>Anaconda3<span class="o">]</span> C:<span class="se">\h</span>ome&gt;activate myblog <span class="c1"># enter &quot;nikola&quot; virtual environment</span>
<a name="rest_code_e8429324dbdf466eb0df0e217729b1c7-2"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome&gt;cd mynikolasite
<a name="rest_code_e8429324dbdf466eb0df0e217729b1c7-3"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome<span class="se">\m</span>ynikolasite&gt;nikola new_post
</pre><p>Nikola提供这种方式生成reStructuredText文档, 并存放在posts目录下,
(markdown文档使用 <tt class="docutils literal">nikola new_post <span class="pre">-f</span> markdown</tt>).
每产生个文档中都含有metadata, 包括标题, 作者等信息. 支持汉字作为标题,
汉字会被自动转换为拼音作为文件名, 如:</p>
<pre class="code shell"><a name="rest_code_5707ed5de80145ed818b83641be8a006-1"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome<span class="se">\m</span>ynikolasite&gt;nikola new_post -f markdown
<a name="rest_code_5707ed5de80145ed818b83641be8a006-2"></a>Creating New Post
<a name="rest_code_5707ed5de80145ed818b83641be8a006-3"></a>Title: markdown <span class="nb">test</span> 我了个去呀
<a name="rest_code_5707ed5de80145ed818b83641be8a006-4"></a>Scanning posts..........done!
<a name="rest_code_5707ed5de80145ed818b83641be8a006-5"></a><span class="o">[</span>2016-04-23T07:47:55Z<span class="o">]</span> INFO: new_post: Your post<span class="err">&#39;</span>s text is at: posts<span class="se">\m</span>arkdown-test-wo-liao-ge-qu-ya.md
</pre><p>我们可以将一些信息(比如作者)放在 <tt class="docutils literal">conf.py</tt> 中,
这样所有post都不用再指定作者信息了:</p>
<pre class="code python"><a name="rest_code_32e05bd0c13442e0952fa042c3926662-1"></a><span class="n">ADDITIONAL_METADATA</span> <span class="o">=</span> <span class="p">{</span>
<a name="rest_code_32e05bd0c13442e0952fa042c3926662-2"></a>    <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;defnil&#39;</span>
<a name="rest_code_32e05bd0c13442e0952fa042c3926662-3"></a><span class="p">}</span>
</pre><p>当然也可以手动在 <tt class="docutils literal">posts/</tt> 目录下新建文档, 还可以在里面新建多层目录,
非常灵活. metadata 中比较重要的有:</p>
<ul class="simple">
<li>在 <tt class="docutils literal">tags</tt> 中可包含多个标签, 用逗号隔开.<ul>
<li><tt class="docutils literal">draft</tt> 表示该文不会被收入索引, 但它默认会被发布. 禁止发布带有
<tt class="docutils literal">draft</tt> 标签的草稿, 在设置文件 <tt class="docutils literal">conf.py</tt> 中设置
<tt class="docutils literal">DEPLOY_DRAFTS</tt> 为 <tt class="docutils literal">False</tt>. 当然前提是 <tt class="docutils literal">DEPLOY_COMMANDS</tt>
中没包含 <tt class="docutils literal">nikola build</tt>.</li>
<li><tt class="docutils literal">tags</tt> 中含有 <tt class="docutils literal">private</tt> 的post不会被收入索引, 但会被发布.
通过网址可以直接被访问到.</li>
</ul>
</li>
<li>Post Types: text and micro. 前者为普通文章, 后者为微博.</li>
<li><tt class="docutils literal">nocomments</tt>: 设置为 <tt class="docutils literal">True</tt> 可以禁止本文的评论</li>
<li><tt class="docutils literal">password</tt>: 可以为文章设置密码, 访问者需要输入密码才可以打开页面.</li>
</ul>
</div>
<div class="section" id="math">
<h2>Math</h2>
<ul>
<li><p class="first">要显示latex公式, 需要在post的 <tt class="docutils literal">tags</tt> 里加入 <tt class="docutils literal">mathjax</tt>.</p>
</li>
<li><p class="first">inline math 不再支持 <tt class="docutils literal">$inline$</tt> 形式, 而使用 <tt class="docutils literal">\(inline\)</tt>
(有的情况下需要使用 <tt class="docutils literal"><span class="pre">\\(inline\\)</span></tt>), 如</p>
<pre class="code text"><a name="rest_code_83e84d40711b4c4a9bf8c88a16d01a06-1"></a>Euler’s formula: \(e^{ix} = \cos x + i\sin x\)
</pre><p>在reST文件中还可以使用 <tt class="docutils literal">:math:</tt> (推荐):</p>
<pre class="code text"><a name="rest_code_4f0514418beb481e81fea1ab18cde578-1"></a>Euler’s formula: :math:`e^{ix} = \cos x + i\sin x`
</pre></li>
<li><p class="first">display math 使用 <tt class="docutils literal"><span class="pre">\[\]</span></tt>, reST中推荐下面这种形式:</p>
<pre class="code text"><a name="rest_code_8aaf87b87f2c4e858436b913399d60cd-1"></a>.. math::
<a name="rest_code_8aaf87b87f2c4e858436b913399d60cd-2"></a>
<a name="rest_code_8aaf87b87f2c4e858436b913399d60cd-3"></a>   \int \frac{dx}{1+ax}=\frac{1}{a}\ln(1+ax)+C
</pre></li>
</ul>
</div>
<div class="section" id="rest">
<h2>reST中插入多种格式</h2>
<div class="section" id="media">
<h3>media</h3>
<pre class="code text"><a name="rest_code_aa29e733e6e345f2b56c31defce07208-1"></a>.. media:: http://vimeo.com/72425090
<a name="rest_code_aa29e733e6e345f2b56c31defce07208-2"></a>.. media:: http://www.youtube.com/watch?v=wyRpAat5oz0
</pre></div>
<div class="section" id="youtube-vimeo-soundcloud">
<h3>YouTube, Vimeo, Soundcloud</h3>
<pre class="code text"><a name="rest_code_8709f4b84b934e7ca1b713f5f310f064-1"></a>.. youtube:: 8N_tupPBtWQ
<a name="rest_code_8709f4b84b934e7ca1b713f5f310f064-2"></a>
<a name="rest_code_8709f4b84b934e7ca1b713f5f310f064-3"></a>.. vimeo:: 20241459
<a name="rest_code_8709f4b84b934e7ca1b713f5f310f064-4"></a>
<a name="rest_code_8709f4b84b934e7ca1b713f5f310f064-5"></a>.. vimeo:: 20241459
<a name="rest_code_8709f4b84b934e7ca1b713f5f310f064-6"></a>   :height: 240
<a name="rest_code_8709f4b84b934e7ca1b713f5f310f064-7"></a>   :width: 320
<a name="rest_code_8709f4b84b934e7ca1b713f5f310f064-8"></a>
<a name="rest_code_8709f4b84b934e7ca1b713f5f310f064-9"></a>[soundcloud url=&quot;http://api.soundcloud.com/tracks/78131362&quot;
<a name="rest_code_8709f4b84b934e7ca1b713f5f310f064-10"></a>
<a name="rest_code_8709f4b84b934e7ca1b713f5f310f064-11"></a>.. soundcloud:: 78131362
</pre></div>
<div class="section" id="code">
<h3>Code</h3>
<pre class="code text"><a name="rest_code_d504869de8fb4989957fee7a879f050d-1"></a>.. code-block:: python
<a name="rest_code_d504869de8fb4989957fee7a879f050d-2"></a>   :number-lines:
<a name="rest_code_d504869de8fb4989957fee7a879f050d-3"></a>
<a name="rest_code_d504869de8fb4989957fee7a879f050d-4"></a>   print(&quot;Our virtues and our failings are inseparable&quot;)
</pre></div>
<div class="section" id="listing">
<h3>Listing</h3>
<p>将 <tt class="docutils literal">foo.py</tt> 文件放在 <tt class="docutils literal">LISTINGS_FOLDERS</tt> 指定的目录下.</p>
<pre class="code text"><a name="rest_code_349623354dcf40e4b7cbd3c0764ceff7-1"></a>.. listing:: foo.py python
</pre></div>
<div class="section" id="gist">
<h3>Gist</h3>
<pre class="code text"><a name="rest_code_e9537502e3b34d0bba0986bdf7144dbb-1"></a>.. gist:: 2395294
</pre></div>
<div class="section" id="thumbnails">
<h3>Thumbnails</h3>
<p>To include an image placed in the <tt class="docutils literal">images</tt> folder (or other folders
defined in IMAGE<sub>FOLDERS</sub>), use the thumbnail directive, like
this:</p>
<pre class="code text"><a name="rest_code_610263a173e5492a8c28678297d6e7b6-1"></a>.. thumbnail:: ../tesla.jpg
<a name="rest_code_610263a173e5492a8c28678297d6e7b6-2"></a>
<a name="rest_code_610263a173e5492a8c28678297d6e7b6-3"></a>   Nikola Tesla, the man that invented the 20th century.
</pre></div>
<div class="section" id="slideshows">
<h3>Slideshows</h3>
<pre class="code text"><a name="rest_code_82354bbcc16a41d9aed449fbcc7b20a2-1"></a>.. slides::
<a name="rest_code_82354bbcc16a41d9aed449fbcc7b20a2-2"></a>
<a name="rest_code_82354bbcc16a41d9aed449fbcc7b20a2-3"></a>   /galleries/demo/tesla_conducts_lg.jpg
<a name="rest_code_82354bbcc16a41d9aed449fbcc7b20a2-4"></a>   /galleries/demo/tesla_lightning2_lg.jpg
<a name="rest_code_82354bbcc16a41d9aed449fbcc7b20a2-5"></a>   /galleries/demo/tesla4_lg.jpg
<a name="rest_code_82354bbcc16a41d9aed449fbcc7b20a2-6"></a>   /galleries/demo/tesla_lightning1_lg.jpg
<a name="rest_code_82354bbcc16a41d9aed449fbcc7b20a2-7"></a>   /galleries/demo/tesla_tower1_lg.jpg
</pre></div>
<div class="section" id="chart">
<h3>Chart</h3>
<p>可以参考 <a class="reference external" href="http://www.pygal.org/en/latest/">这里</a></p>
<pre class="code text"><a name="rest_code_aeb04fd45ba24308a9f90753dd14062a-1"></a>.. chart:: Bar
<a name="rest_code_aeb04fd45ba24308a9f90753dd14062a-2"></a>   :title: &#39;Browser usage evolution (in %)&#39;
<a name="rest_code_aeb04fd45ba24308a9f90753dd14062a-3"></a>   :x_labels: [&quot;2002&quot;, &quot;2003&quot;, &quot;2004&quot;, &quot;2005&quot;, &quot;2006&quot;, &quot;2007&quot;]
<a name="rest_code_aeb04fd45ba24308a9f90753dd14062a-4"></a>   &#39;Firefox&#39;, [None, None, 0, 16.6, 25, 31]
<a name="rest_code_aeb04fd45ba24308a9f90753dd14062a-5"></a>   &#39;Chrome&#39;,  [None, None, None, None, None, None]
<a name="rest_code_aeb04fd45ba24308a9f90753dd14062a-6"></a>   &#39;IE&#39;,      [85.8, 84.6, 84.7, 74.5, 66, 58.6]
<a name="rest_code_aeb04fd45ba24308a9f90753dd14062a-7"></a>   &#39;Others&#39;,  [14.2, 15.4, 15.3, 8.9, 9, 10.4]
</pre></div>
<div class="section" id="doc">
<h3>Doc</h3>
<p>用于跳转到其它页面.</p>
<pre class="code text"><a name="rest_code_8958d01dbac04453942bce59e82573d7-1"></a>Take a look at :doc:`my other post &lt;creating-a-theme&gt;` about theme creating.
<a name="rest_code_8958d01dbac04453942bce59e82573d7-2"></a>Take a look at :doc:`creating-a-theme` to know how to do it.
</pre></div>
</div>
</div>
<div class="section" id="org-mode">
<h1>Org-Mode</h1>
<ul>
<li><p class="first">安装插件</p>
<pre class="code shell"><a name="rest_code_300b8b3d0f914a78b9f979296f6f92f9-1"></a><span class="o">[</span>Anaconda3<span class="o">]</span> C:<span class="se">\h</span>ome&gt;activate myblog
<a name="rest_code_300b8b3d0f914a78b9f979296f6f92f9-2"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome&gt;nikola plugin -i orgmode
</pre></li>
<li><p class="first">在 <tt class="docutils literal">conf.py</tt> 中 <tt class="docutils literal">COMPILERS</tt>, <tt class="docutils literal">POSTS</tt>, <tt class="docutils literal">PAGES</tt> 项中加入下和 <tt class="docutils literal">.org</tt> 有关的内容 (参考本项目中的 conf.py 文件)。</p>
</li>
<li><p class="first">创建org文档</p>
<pre class="code shell"><a name="rest_code_252b2080781141e691cdf6a41bf0a6df-1"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome&gt;cd mynikolasite
<a name="rest_code_252b2080781141e691cdf6a41bf0a6df-2"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome<span class="se">\m</span>ynikolasite&gt;nikola new_post -f orgmode
</pre></li>
<li><p class="first">build</p>
<pre class="code shell"><a name="rest_code_2c3a302260644e73b46245d504aeae3c-1"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome<span class="se">\m</span>ynikolasite&gt;nikola auto -b
</pre><p>会自动检查文件变化并build, <tt class="docutils literal"><span class="pre">-b</span></tt> 是打开流览器(Windows下尝试
<tt class="docutils literal">nikola auto</tt> 总是失败(因为内部调用的 <tt class="docutils literal">epoll</tt> 命令在win下无效),
还是老老实实使用 <tt class="docutils literal">nikola build</tt> 和 <tt class="docutils literal">nikola serve</tt> 再访问
<a class="reference external" href="http:localhost:8000">http:localhost:8000</a> 吧).
注意emacs.exe所在目录必须要添加到系统环境变量PATH中,
否则会找不到emacs而报错.</p>
</li>
</ul>
</div>
<div class="section" id="markdown">
<h1>Markdown</h1>
<div class="section" id="set-as-default-format">
<h2>Set as Default Format</h2>
<p>如果要将markdown或者其它格式设置为默认格式, 只需将其放在 <tt class="docutils literal">POSTS</tt> 和
<tt class="docutils literal">PAGES</tt> 第一个位置, 这样以后在执行 <tt class="docutils literal">nikola new_post</tt> 时不用加参数,
会默认生成 <tt class="docutils literal">.md</tt> 文件:</p>
<pre class="code python"><a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-1"></a><span class="n">POSTS</span> <span class="o">=</span> <span class="p">(</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-2"></a>    <span class="p">(</span><span class="s2">&quot;posts/*.md&quot;</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;post.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-3"></a>    <span class="p">(</span><span class="s2">&quot;posts/*.rst&quot;</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;post.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-4"></a>    <span class="p">(</span><span class="s2">&quot;posts/*.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;post.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-5"></a>    <span class="p">(</span><span class="s2">&quot;posts/*.html&quot;</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;post.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-6"></a>    <span class="p">(</span><span class="s2">&quot;posts/*.ipynb&quot;</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;post.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-7"></a><span class="p">)</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-8"></a><span class="n">PAGES</span> <span class="o">=</span> <span class="p">(</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-9"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.md&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-10"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.rst&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-11"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-12"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.html&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-13"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.ipynb&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_775f9f59b17e401b8d88d182dbbfd6b8-14"></a><span class="p">)</span>
</pre></div>
<div class="section" id="extensions">
<h2>Extensions</h2>
<p>nikola默认使用的python-markdown遵循standard markdown
<a class="reference external" href="http://daringfireball.net/projects/markdown/">标准</a>,
如果要使用Github Favored Markdown
(<a class="reference external" href="https://help.github.com/articles/github-flavored-markdown">GFM</a>),
可以利用python-markdown中的一些
<a class="reference external" href="http://pythonhosted.org/Markdown/extensions/">extensions</a>
来尽量模拟GFM格式:</p>
<ul class="simple">
<li><a class="reference external" href="http://pythonhosted.org/Markdown/extensions/nl2br.html">nl2br</a>:
newline to linebreak</li>
<li><a class="reference external" href="http://pythonhosted.org/Markdown/extensions/fenced_code_blocks.html">fenced-code</a>:
fenced code blocks</li>
<li><a class="reference external" href="http://pythonhosted.org/Markdown/extensions/smart_strong.html">smart-strong</a>:
do not boldify multiple underscores in words</li>
<li><a class="reference external" href="http://pythonhosted.org/Markdown/extensions/code_hilite.html">codehilite</a>:
syntax highlighting (using <a class="reference external" href="http://pygments.org">Pygments</a>)</li>
<li><a class="reference external" href="http://pythonhosted.org/Markdown/extensions/footnotes.html">footnotes</a>:
Footnots in markdown</li>
</ul>
<p>可以设置 <tt class="docutils literal">conf.py</tt> 文件中的 <tt class="docutils literal">MARKDOWN_EXTENSIONS</tt>
变量来使用这些extensions, 如:</p>
<pre class="code python"><a name="rest_code_b8bd34dc027b4e16aab3cffe27a6d912-1"></a><span class="n">MARKDOWN_EXTENSIONS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;nl2br&quot;</span><span class="p">,</span> <span class="s2">&quot;fenced_code&quot;</span><span class="p">,</span> <span class="s2">&quot;footnotes&quot;</span><span class="p">,</span>
<a name="rest_code_b8bd34dc027b4e16aab3cffe27a6d912-2"></a><span class="s2">&quot;smart_strong&quot;</span><span class="p">,</span><span class="s2">&quot;codehilite(linenums=True)&quot;</span><span class="p">,</span> <span class="s1">&#39;extra&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="customization">
<h1>Customization</h1>
<div class="section" id="install-theme">
<h2>Install Theme</h2>
<p>Themes can be found <a class="reference external" href="https://themes.getnikola.com/">here</a> and
installed with <tt class="docutils literal">nikola install_theme themename</tt>. Here <em>bootstrap3</em> is
a very good choice among them, since it supports
<a class="reference external" href="https://bootswatch.com/">Bootswatch</a> schemes. For example, to use
<em>Superhero</em> scheme on this <a class="reference external" href="https://bootswatch.com/superhero/">page</a>,
just run</p>
<pre class="code shell"><a name="rest_code_be5ba1d79c664b56ad91daaa87f2ff9e-1"></a><span class="o">[</span>myblog<span class="o">]</span> C:<span class="se">\h</span>ome<span class="se">\m</span>ynikolasite&gt;nikola bootswatch_theme -n custum_theme -s superhero -p bootstrap3
</pre><p>after installing <em>bootstrap3</em> theme. To enable this custom scheme, you
need set <tt class="docutils literal">THEME</tt> to “custom” in <tt class="docutils literal">conf.py</tt>.</p>
<p>To further tweak your theme, please refer to <a class="reference external" href="https://getnikola.com/theming.html">Theming
Nikola</a>.</p>
</div>
<div class="section" id="author-page">
<h2>Author Page</h2>
<p>如果你每篇post的作者署名不一致, nikola会判断有多个作者,
因此会自动产生一个Author Page. 当点击每个post上的Author名时,
会转向这名作者的页面. 因此需要按此
<a class="reference external" href="https://getnikola.com/blog/author-pages-in-nikola-v770.html">说明</a>
进一步设置. 即: 将 <tt class="docutils literal">AUTHOR_PAGES_ARE_INDEXES</tt> 设为 <tt class="docutils literal">False</tt>,
然后设置每个作者的描述:</p>
<pre class="code python"><a name="rest_code_cd9ad8be25b041c2aa56103435bffa0b-1"></a><span class="n">ENABLE_AUTHOR_PAGES</span> <span class="o">=</span> <span class="bp">True</span>
<a name="rest_code_cd9ad8be25b041c2aa56103435bffa0b-2"></a><span class="n">AUTHOR_PAGES_ARE_INDEXES</span> <span class="o">=</span> <span class="bp">False</span>
<a name="rest_code_cd9ad8be25b041c2aa56103435bffa0b-3"></a><span class="n">AUTHOR_PATH</span> <span class="o">=</span> <span class="s2">&quot;authors&quot;</span>
<a name="rest_code_cd9ad8be25b041c2aa56103435bffa0b-4"></a><span class="n">AUTHOR_PAGES_DESCRIPTIONS</span> <span class="o">=</span> <span class="p">{</span>
<a name="rest_code_cd9ad8be25b041c2aa56103435bffa0b-5"></a>    <span class="n">DEFAULT_LANG</span><span class="p">:</span> <span class="p">{</span>
<a name="rest_code_cd9ad8be25b041c2aa56103435bffa0b-6"></a>        <span class="s2">&quot;defnil&quot;</span><span class="p">:</span> <span class="s2">&quot;Old posts&quot;</span><span class="p">,</span>
<a name="rest_code_cd9ad8be25b041c2aa56103435bffa0b-7"></a>        <span class="s2">&quot;YONG&quot;</span><span class="p">:</span> <span class="s2">&quot;^_^&quot;</span>
<a name="rest_code_cd9ad8be25b041c2aa56103435bffa0b-8"></a>    <span class="p">},</span>
<a name="rest_code_cd9ad8be25b041c2aa56103435bffa0b-9"></a><span class="p">}</span>
<a name="rest_code_cd9ad8be25b041c2aa56103435bffa0b-10"></a><span class="n">HIDDEN_AUTHORS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Guest&#39;</span><span class="p">]</span>
</pre><p><em>bootstrap3</em> 主题已将这些页面包含在内,
因此作上述设置后就可以直接看到结果了. 如果你要完全禁止这个功能,
也很简单, 将 <tt class="docutils literal">ENABLE_AUTHOR_PAGES</tt> 设为 <tt class="docutils literal">False</tt> 即可.</p>
</div>
<div class="section" id="footer">
<h2>Footer</h2>
<p>这里主要是在页面下显示 “Contents 2016 authorname - Powered by Nikola”
字样. 可以在 <tt class="docutils literal">CONTENT_FOOTER</tt> 中做修改.</p>
</div>
<div class="section" id="navigation-pane">
<h2>Navigation Pane</h2>
<p>可以在 <tt class="docutils literal">NAVIGATION_LINKS</tt> 里添加要链接的页面即可. 比如新建了一个名为
<tt class="docutils literal">about.rst</tt> 的page (会被存放在 <tt class="docutils literal">pages/</tt> 目录下),
如果要将它放在导航栏里:</p>
<pre class="code python"><a name="rest_code_772db906ac204ffc8e9624b3b4bc2b9e-1"></a><span class="n">NAVIGATION_LINKS</span> <span class="o">=</span> <span class="p">{</span>
<a name="rest_code_772db906ac204ffc8e9624b3b4bc2b9e-2"></a>    <span class="n">DEFAULT_LANG</span><span class="p">:</span> <span class="p">(</span>
<a name="rest_code_772db906ac204ffc8e9624b3b4bc2b9e-3"></a>        <span class="p">(</span><span class="s2">&quot;/archive.html&quot;</span><span class="p">,</span> <span class="s2">&quot;Archive&quot;</span><span class="p">),</span>
<a name="rest_code_772db906ac204ffc8e9624b3b4bc2b9e-4"></a>        <span class="p">(</span><span class="s2">&quot;/categories/&quot;</span><span class="p">,</span> <span class="s2">&quot;Tags&quot;</span><span class="p">),</span>
<a name="rest_code_772db906ac204ffc8e9624b3b4bc2b9e-5"></a>        <span class="p">(</span><span class="s2">&quot;/pages/about/index.html&quot;</span><span class="p">,</span> <span class="s2">&quot;About&quot;</span><span class="p">),</span> <span class="c1"># need to be changed to /output/index.html after you set your own homepage</span>
<a name="rest_code_772db906ac204ffc8e9624b3b4bc2b9e-6"></a>        <span class="p">(</span><span class="s2">&quot;/rss.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;RSS feed&quot;</span><span class="p">),</span>
<a name="rest_code_772db906ac204ffc8e9624b3b4bc2b9e-7"></a>    <span class="p">),</span>
<a name="rest_code_772db906ac204ffc8e9624b3b4bc2b9e-8"></a><span class="p">}</span>
</pre><p>根据 <a class="reference external" href="https://getnikola.com/handbook.html">Nikola Handbook</a> 的说法,
导航栏至多支持一级子菜单 “Only one level of submenus is supported”,
可以参照说明设置带子菜单样式的导航栏.</p>
</div>
<div class="section" id="disqus">
<h2>评论功能 DISQUS</h2>
<pre class="code python"><a name="rest_code_4b2bdab2b71f461daecc373f9d2ddad2-1"></a><span class="n">COMMENT_SYSTEM</span> <span class="o">=</span> <span class="s2">&quot;disqus&quot;</span>
<a name="rest_code_4b2bdab2b71f461daecc373f9d2ddad2-2"></a><span class="n">COMMENT_SYSTEM_ID</span> <span class="o">=</span> <span class="s2">&quot;yongch&quot;</span> <span class="c1"># your disqus ID</span>
</pre></div>
<div class="section" id="image-size">
<h2>Image Size</h2>
<p><tt class="docutils literal">MAX_IMAGE_SIZE</tt> 可以决定图片大小,
设置一个合理的数字可以保证所有页面中的图片不至于太大.
还有其它关于image的选项可以酌情选择.</p>
<p>另外所有放在 <tt class="docutils literal">images/</tt> 下面的图片都会被复制到 <tt class="docutils literal">output/</tt>
里并且会为每张图片自动生成thumbnail图片. 因此如果不想产生Thumbnail,
就直接把图片放在 <tt class="docutils literal">files/images/</tt> 目录下.</p>
</div>
<div class="section" id="set-your-own-homepage">
<h2>Set Your Own Homepage</h2>
<p>让网页更像site而不是blog,
<a class="reference external" href="https://getnikola.com/creating-a-site-not-a-blog-with-nikola.html">这里</a>
有如何建一个site的步骤. 对于已经按blog建立的站点,
我们可以进行下面的改造.</p>
<pre class="code python"><a name="rest_code_696035a6afd14012a94ab42edbbf8511-1"></a><span class="n">INDEX_PATH</span> <span class="o">=</span> <span class="s2">&quot;posts&quot;</span>
<a name="rest_code_696035a6afd14012a94ab42edbbf8511-2"></a><span class="n">PAGES</span> <span class="o">=</span> <span class="p">(</span>
<a name="rest_code_696035a6afd14012a94ab42edbbf8511-3"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.rst&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_696035a6afd14012a94ab42edbbf8511-4"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_696035a6afd14012a94ab42edbbf8511-5"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.html&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_696035a6afd14012a94ab42edbbf8511-6"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.md&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_696035a6afd14012a94ab42edbbf8511-7"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.ipynb&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_696035a6afd14012a94ab42edbbf8511-8"></a>    <span class="p">(</span><span class="s2">&quot;pages/*.org&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;story.tmpl&quot;</span><span class="p">),</span>
<a name="rest_code_696035a6afd14012a94ab42edbbf8511-9"></a><span class="p">)</span>
</pre><p>然后我们可以使用 <tt class="docutils literal">nikola new_page <span class="pre">-t</span> Home</tt> 创建一个名为 “Home” 的页面.
(slug 改为index). 现在我们还需要根据 <tt class="docutils literal">output/</tt>
下目录的变化重新调整导航栏, 并且把posts放到“Posts”导航栏里. 如下图：</p>
<pre class="code python"><a name="rest_code_2c5414d833694a088947555fe0635c70-1"></a><span class="n">NAVIGATION_LINKS</span> <span class="o">=</span> <span class="p">{</span>
<a name="rest_code_2c5414d833694a088947555fe0635c70-2"></a>    <span class="n">DEFAULT_LANG</span><span class="p">:</span> <span class="p">(</span>
<a name="rest_code_2c5414d833694a088947555fe0635c70-3"></a>        <span class="p">(</span><span class="s2">&quot;/posts/&quot;</span><span class="p">,</span> <span class="s2">&quot;Posts&quot;</span><span class="p">),</span>
<a name="rest_code_2c5414d833694a088947555fe0635c70-4"></a>        <span class="p">(</span><span class="s2">&quot;/categories/&quot;</span><span class="p">,</span> <span class="s2">&quot;Tags&quot;</span><span class="p">),</span>
<a name="rest_code_2c5414d833694a088947555fe0635c70-5"></a>        <span class="p">(</span><span class="s2">&quot;/Notes/index.html&quot;</span><span class="p">,</span> <span class="s2">&quot;Notes&quot;</span><span class="p">),</span>
<a name="rest_code_2c5414d833694a088947555fe0635c70-6"></a>        <span class="p">(</span><span class="s2">&quot;/archive.html&quot;</span><span class="p">,</span> <span class="s2">&quot;Archive&quot;</span><span class="p">),</span>
<a name="rest_code_2c5414d833694a088947555fe0635c70-7"></a>        <span class="p">(</span><span class="s2">&quot;/rss.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;RSS&quot;</span><span class="p">),</span>
<a name="rest_code_2c5414d833694a088947555fe0635c70-8"></a>        <span class="p">(</span><span class="s2">&quot;/about/index.html&quot;</span><span class="p">,</span> <span class="s2">&quot;About&quot;</span><span class="p">),</span>
<a name="rest_code_2c5414d833694a088947555fe0635c70-9"></a>    <span class="p">),</span>
<a name="rest_code_2c5414d833694a088947555fe0635c70-10"></a><span class="p">}</span>
</pre><p>这时可以编辑你自己的 <tt class="docutils literal">home.rst</tt> 了. 也可以直接用我们之前做的
<tt class="docutils literal">about.rst</tt> 链接过来做主页: <tt class="docutils literal">.. include:: pages/about.rst</tt>.
如果你正在使用基于 <em>bootstrap3</em> 的主题, 因为它基于 <tt class="docutils literal">Bootstrap</tt>,
因此任何 <tt class="docutils literal">Bootstrap</tt> 支持的格式都可以用 <tt class="docutils literal">.rst</tt> 来表达. 可以参考
<a class="reference external" href="https://getnikola.com/creating-a-site-not-a-blog-with-nikola.html">这里</a>
的一个例子来写主页. 更多语法上的参考还可以看
<a class="reference external" href="https://github.com/rougier/bootstrap-rst">这里</a>.</p>
</div>
</div>
